#!/bin/bash
#
# ~/etc/install [DestDir]
#
set -e
set -u
#set -x

sourcedir="$(dirname $0)"
destdir="${1:-$HOME}"

symlinks=(
bashrc
bash_profile
vimrc
vim
screenrc
rpmmacros
gitignore_global
)
echo "install $sourcedir symlinks into $destdir ..."
for link in ${symlinks[@]}; do
    src="$sourcedir/${link}"
    dst="$destdir/.${link}"
    if [ -e "$dst" ] && [ ! -L "$dst" ]
    then
        mv -v "$dst" "$dst~"
    fi
    ln -nsfv "$src" "$dst"
done


git=$(which git)
if $git --version >/dev/null
then
    echo "install $git configuration ..."
    gitconfig="$git config --replace --global"
    $gitconfig color.ui true
    $gitconfig core.excludesfile "~/.gitignore_global"
    $gitconfig log.decorate "short"
    $gitconfig alias.b  "branch"
    $gitconfig alias.ci "commit --verbose"
    $gitconfig alias.co "checkout"
    $gitconfig alias.d  "diff"
    $gitconfig alias.dc "diff --cached"
    $gitconfig alias.l  "log --oneline --graph --decorate"
    $gitconfig alias.s  "status --short --branch"
    $gitconfig alias.st "status"
    $gitconfig alias.cp "cherry-pick"
fi
